<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ ponto.nome }} - Turismo pelo Sudeste</title>
    <link rel="stylesheet" href="/static/css/ponto_detalhes.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap" async defer></script>
</head>
<body>
    {% set mensagem = get_flashed_messages() %}
    {% if mensagem %}
        <div class="flash_alerta">
            {{ mensagem[0] }}
        </div>
    {% endif %}

    <header class="header">
        <div class="container">
            <div class="logo">
                <h1><i class="fas fa-mountain"></i> Ponto de Partida</h1>
            </div>
            <nav class="nav">
                <a href="/dashboard" class="nav-link">
                    <i class="fas fa-home"></i> Início
                </a>
                <a href="/perfil" class="nav-link">
                    <i class="fas fa-user"></i> Perfil
                </a>
                <a href="/logout" class="nav-link logout">
                    <i class="fas fa-sign-out-alt"></i> Sair
                </a>
            </nav>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <div class="breadcrumb">
                <a href="/dashboard"><i class="fas fa-home"></i> Início</a>
                <span><i class="fas fa-chevron-right"></i></span>
                <span>{{ ponto.nome }}</span>
            </div>

            <div class="ponto-header">
                <div class="ponto-image">
                    <img src="/static/uploads/{{ ponto.imagem or 'default.jpg' }}" alt="{{ ponto.nome }}" onerror="this.src='/static/css/imagens/default.jpg'">
                    <div class="categoria-badge">{{ ponto.categoria }}</div>
                </div>
                <div class="ponto-info-header">
                    <h1>{{ ponto.nome }}</h1>
                    <p class="endereco"><i class="fas fa-map-marker-alt"></i> {{ ponto.endereco }}</p>
                    <div class="info-grid">
                        <div class="info-item">
                            <i class="fas fa-clock"></i>
                            <div>
                                <strong>Horário:</strong>
                                <span>{{ ponto.horario_funcionamento or 'Não informado' }}</span>
                            </div>
                        </div>
                        <div class="info-item">
                            <i class="fas fa-ticket-alt"></i>
                            <div>
                                <strong>Entrada:</strong>
                                <span>{{ ponto.preco_entrada or 'Gratuito' }}</span>
                            </div>
                        </div>
                        {% if ponto.telefone_contato %}
                        <div class="info-item">
                            <i class="fas fa-phone"></i>
                            <div>
                                <strong>Telefone:</strong>
                                <span>{{ ponto.telefone_contato }}</span>
                            </div>
                        </div>
                        {% endif %}
                        {% if ponto.site_oficial %}
                        <div class="info-item">
                            <i class="fas fa-globe"></i>
                            <div>
                                <strong>Site:</strong>
                                <a href="{{ ponto.site_oficial }}" target="_blank">{{ ponto.site_oficial }}</a>
                            </div>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>

            <div class="ponto-content">
                <div class="descricao-section">
                    <h2>Sobre o Local</h2>
                    <p>{{ ponto.descricao }}</p>
                </div>

                <div class="mapa-section">
                    <h2>Localização</h2>
                    <div id="map" class="mapa-container"></div>
                    <div class="mapa-acoes">
                        <button id="btn-direcoes" class="btn-direcoes">
                            <i class="fas fa-directions"></i> Obter Direções
                        </button>
                        <button id="btn-compartilhar" class="btn-compartilhar">
                            <i class="fas fa-share"></i> Compartilhar Localização
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 Turismo pelo Sudeste. Todos os direitos reservados.</p>
        </div>
    </footer>

    <script>
        let map;
        let marker;

        function initMap() {
            const ponto = {
                lat: {{ ponto.latitude }},
                lng: {{ ponto.longitude }}
            };

            map = new google.maps.Map(document.getElementById('map'), {
                zoom: 15,
                center: ponto,
                mapTypeId: 'roadmap'
            });

            marker = new google.maps.Marker({
                position: ponto,
                map: map,
                title: '{{ ponto.nome }}',
                animation: google.maps.Animation.DROP
            });

            const infoWindow = new google.maps.InfoWindow({
                content: `
                    <div style="padding: 10px;">
                        <h3>{{ ponto.nome }}</h3>
                        <p>{{ ponto.endereco }}</p>
                        <p><strong>Horário:</strong> {{ ponto.horario_funcionamento or 'Não informado' }}</p>
                        <p><strong>Entrada:</strong> {{ ponto.preco_entrada or 'Gratuito' }}</p>
                    </div>
                `
            });

            marker.addListener('click', function() {
                infoWindow.open(map, marker);
            });
        }

        // Botão de direções
        document.getElementById('btn-direcoes').addEventListener('click', function() {
            const url = `https://www.google.com/maps/dir/?api=1&destination={{ ponto.latitude }},{{ ponto.longitude }}`;
            window.open(url, '_blank');
        });

        // Botão de compartilhar
        document.getElementById('btn-compartilhar').addEventListener('click', function() {
            if (navigator.share) {
                navigator.share({
                    title: '{{ ponto.nome }}',
                    text: 'Confira este ponto turístico no Rio de Janeiro!',
                    url: window.location.href
                });
            } else {
                // Fallback para navegadores que não suportam Web Share API
                navigator.clipboard.writeText(window.location.href).then(function() {
                    alert('Link copiado para a área de transferência!');
                });
            }
        });
    </script>
</body>
</html>
